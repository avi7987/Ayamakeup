<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Luna - Illuminate your business path</title>
    <meta name="description" content="Luna - Modern business management system to illuminate your business path">
    
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css?v=28122025">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Design System */
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        body {
            background: #FAFAFA;
            color: #1E293B;
        }
        
        /* Mesh Background */
        .mesh-background {
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 50%, #A855F7 100%);
            position: relative;
            overflow: hidden;
        }
        
        .mesh-background::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: 
                radial-gradient(at 27% 37%, hsla(271, 96%, 71%, 0.3) 0px, transparent 50%),
                radial-gradient(at 97% 21%, hsla(244, 90%, 67%, 0.3) 0px, transparent 50%),
                radial-gradient(at 52% 99%, hsla(304, 89%, 73%, 0.3) 0px, transparent 50%),
                radial-gradient(at 10% 29%, hsla(256, 96%, 67%, 0.3) 0px, transparent 50%),
                radial-gradient(at 97% 96%, hsla(293, 93%, 71%, 0.3) 0px, transparent 50%),
                radial-gradient(at 33% 50%, hsla(235, 91%, 65%, 0.3) 0px, transparent 50%),
                radial-gradient(at 79% 53%, hsla(280, 87%, 69%, 0.3) 0px, transparent 50%);
            opacity: 0.7;
        }
        
        /* Fade in animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .fade-in-delay-1 { animation-delay: 0.1s; opacity: 0; }
        .fade-in-delay-2 { animation-delay: 0.2s; opacity: 0; }
        .fade-in-delay-3 { animation-delay: 0.3s; opacity: 0; }
        .fade-in-delay-4 { animation-delay: 0.4s; opacity: 0; }
        
        /* Progress bar animation */
        @keyframes progressFill {
            from { width: 0%; }
        }
        
        .progress-animate {
            animation: progressFill 1.5s ease-out forwards;
        }
        
        /* Moon floating animation */
        @keyframes moonFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .moon-float {
            animation: moonFloat 3s ease-in-out infinite;
            display: inline-block;
        }
        
        /* Card hover effects */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Stat card styles */
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        
        /* Dark Mode Styles */
        body.dark-mode {
            background: #0F172A;
            color: #E2E8F0;
        }
        
        body.dark-mode .mesh-background {
            background: linear-gradient(135deg, #312E81 0%, #581C87 50%, #86198F 100%);
        }
        
        body.dark-mode .stat-card {
            background: #1E293B;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .main-card,
        body.dark-mode .bg-white {
            background: #1f2937 !important;
            color: #e4e4e7;
        }
        body.dark-mode input,
        body.dark-mode select,
        body.dark-mode textarea {
            background: #374151;
            color: #e4e4e7;
            border-color: #4b5563;
        }
        body.dark-mode input::placeholder,
        body.dark-mode textarea::placeholder {
            color: #9ca3af;
        }
        body.dark-mode .text-gray-700,
        body.dark-mode .text-gray-800,
        body.dark-mode .text-gray-900,
        body.dark-mode .text-purple-800,
        body.dark-mode .text-purple-900 {
            color: #e4e4e7 !important;
        }
        /* Modal backgrounds */
        body.dark-mode .modal > div {
            background: #1f2937 !important;
        }
        /* Light backgrounds in dark mode */
        body.dark-mode .bg-gray-50,
        body.dark-mode .bg-gray-100,
        body.dark-mode .bg-purple-50,
        body.dark-mode .bg-blue-50,
        body.dark-mode .bg-green-50 {
            background: #374151 !important;
        }
        /* Border colors */
        body.dark-mode .border-gray-200,
        body.dark-mode .border-gray-300,
        body.dark-mode .border-purple-100,
        body.dark-mode .border-blue-200,
        body.dark-mode .border-green-200 {
            border-color: #4b5563 !important;
        }
        /* Card text colors */
        body.dark-mode .lead-card,
        body.dark-mode .kanban-card {
            background: #374151 !important;
            color: #e4e4e7 !important;
        }
        body.dark-mode .lead-card *,
        body.dark-mode .kanban-card * {
            color: #e4e4e7 !important;
        }
        /* Button text visibility */
        body.dark-mode button:not(.bg-purple-600):not(.bg-green-500):not(.bg-blue-500):not(.bg-red-500):not(.bg-yellow-500) {
            color: #e4e4e7;
        }
        body.dark-mode .text-gray-600 {
            color: #d1d5db !important;
        }
        body.dark-mode .border-gray-300 {
            border-color: #4b5563 !important;
        }
        body.dark-mode .bg-gray-100,
        body.dark-mode .bg-gray-50 {
            background: #374151 !important;
        }
        body.dark-mode .bg-purple-50 {
            background: #4c1d95 !important;
        }
        body.dark-mode .kanban-column {
            background: #1f2937 !important;
        }
        body.dark-mode .lead-card {
            background: #374151 !important;
            border-color: #4b5563 !important;
        }
        /* Comprehensive text color fixes */
        body.dark-mode .text-green-800,
        body.dark-mode .text-pink-800,
        body.dark-mode .text-green-700,
        body.dark-mode .text-pink-700 {
            color: #d1d5db !important;
        }
        /* Label colors in forms */
        body.dark-mode label {
            color: #e4e4e7 !important;
        }
        /* Checkboxes and radio buttons */
        body.dark-mode input[type="checkbox"],
        body.dark-mode input[type="radio"] {
            background-color: #374151;
            border-color: #4b5563;
        }
        /* Stats cards */
        body.dark-mode .stat-card {
            background: #374151 !important;
            border-color: #4b5563 !important;
        }
        /* All text colors that need fixing */
        body.dark-mode .text-gray-500 {
            color: #9ca3af !important;
        }
        body.dark-mode .text-gray-400 {
            color: #9ca3af !important;
        }
        /* Table headers and cells */
        body.dark-mode table th,
        body.dark-mode table td {
            color: #e4e4e7 !important;
            border-color: #4b5563 !important;
        }
        /* Dropdown menus */
        body.dark-mode select option {
            background: #374151;
            color: #e4e4e7;
        }
        /* Progress bars background */
        body.dark-mode .bg-gray-200 {
            background: #4b5563 !important;
        }
        /* All purple/pink text in goals */
        body.dark-mode .text-purple-700,
        body.dark-mode .text-purple-600 {
            color: #c4b5fd !important;
        }
        /* Pink backgrounds in dark mode */
        body.dark-mode .bg-pink-50 {
            background: rgba(219, 39, 119, 0.2) !important;
            border-color: #be185d !important;
        }
        body.dark-mode .bg-pink-50 * {
            color: #fda4af !important;
        }
        /* Input date and time styling */
        body.dark-mode input[type="date"],
        body.dark-mode input[type="time"],
        body.dark-mode input[type="datetime-local"] {
            color-scheme: dark;
        }
        /* Ensure all modal titles are visible */
        body.dark-mode h3,
        body.dark-mode h2,
        body.dark-mode h1 {
            color: #e4e4e7 !important;
        }
        /* Number input arrows visible */
        body.dark-mode input[type="number"]::-webkit-inner-spin-button,
        body.dark-mode input[type="number"]::-webkit-outer-spin-button {
            filter: invert(1);
        }
    </style>
</head>
<body>
    <!-- Side Menu Overlay -->
    <div id="menu-overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-40 hidden transition-opacity duration-300" onclick="closeSideMenu()"></div>
    
    <!-- Side Menu -->
    <div id="side-menu" class="fixed top-0 right-0 h-full w-80 bg-white dark:bg-gray-800 shadow-2xl z-50 transform translate-x-full transition-transform duration-300 flex flex-col">
        <!-- Menu Header -->
        <div class="mesh-background p-6 relative">
            <button onclick="closeSideMenu()" class="absolute top-4 left-4 text-white hover:bg-white/20 p-2 rounded-full transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <div class="text-center">
                <div class="inline-flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-2xl">
                    <span class="text-3xl moon-float">ğŸŒ™</span>
                    <span class="text-2xl font-bold text-white">Luna</span>
                </div>
                <p class="mt-2 text-sm text-white/80">×ª×¤×¨×™×˜ × ×™×•×•×˜</p>
            </div>
        </div>
        
        <!-- Menu Items -->
        <div class="flex-1 overflow-y-auto p-4 space-y-2">
            <!-- Home -->
            <button onclick="switchPageWithMenu('home')" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-purple-50 dark:hover:bg-gray-700 transition-all group" data-page="home">
                <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×‘×™×ª</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">×“×£ ×”×‘×™×ª</p>
                </div>
            </button>
            
            <!-- Leads -->
            <button onclick="switchPageWithMenu('leads')" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-blue-50 dark:hover:bg-gray-700 transition-all group" data-page="leads">
                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×œ×™×“×™×</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">× ×™×”×•×œ ×œ×§×•×—×•×ª</p>
                </div>
            </button>
            
            <!-- Income/Entry -->
            <button onclick="switchPageWithMenu('entry')" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-emerald-50 dark:hover:bg-gray-700 transition-all group" data-page="entry">
                <div class="w-10 h-10 bg-gradient-to-br from-emerald-500 to-green-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×”×›× ×¡×•×ª</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">×”×•×¡×¤×ª ×”×›× ×¡×•×ª</p>
                </div>
            </button>
            
            <!-- Statistics -->
            <button onclick="switchPageWithMenu('stats')" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-amber-50 dark:hover:bg-gray-700 transition-all group" data-page="stats">
                <div class="w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×¡×˜×˜×™×¡×˜×™×§×•×ª</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">×“×•×—×•×ª ×•× ×™×ª×•×—×™×</p>
                </div>
            </button>
            
            <!-- Insights -->
            <button onclick="switchPageWithMenu('insights')" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-pink-50 dark:hover:bg-gray-700 transition-all group" data-page="insights">
                <div class="w-10 h-10 bg-gradient-to-br from-pink-500 to-rose-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×ª×•×‘× ×•×ª</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">× ×™×ª×•×— ×¢×¡×§×™</p>
                </div>
            </button>
            
            <!-- Divider -->
            <div class="border-t border-gray-200 dark:border-gray-700 my-2"></div>
            
            <!-- Contracts (Future) -->
            <button onclick="showComingSoon('×—×•×–×™×')" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all group opacity-60">
                <div class="w-10 h-10 bg-gradient-to-br from-gray-400 to-gray-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×—×•×–×™×</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">×‘×§×¨×•×‘...</p>
                </div>
            </button>
            
            <!-- Social (Future) -->
            <button onclick="showComingSoon('×¡×•×©×™××œ')" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all group opacity-60">
                <div class="w-10 h-10 bg-gradient-to-br from-gray-400 to-gray-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×¡×•×©×™××œ</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">×‘×§×¨×•×‘...</p>
                </div>
            </button>
            
            <!-- Divider -->
            <div class="border-t border-gray-200 dark:border-gray-700 my-2"></div>
            
            <!-- Settings -->
            <button onclick="openModal('modal-settings'); closeSideMenu();" class="menu-item w-full text-right p-4 rounded-xl flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all group">
                <div class="w-10 h-10 bg-gradient-to-br from-gray-600 to-gray-700 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">×”×’×“×¨×•×ª</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">×”×’×“×¨×•×ª ××¢×¨×›×ª</p>
                </div>
            </button>
        </div>
        
        <!-- Menu Footer -->
        <div class="p-4 border-t border-gray-200 dark:border-gray-700 space-y-2">
            <div class="text-center text-xs text-gray-500 dark:text-gray-400">
                <p>Luna CRM System</p>
                <p class="mt-1">Version 2.0</p>
            </div>
        </div>
    </div>
    
    <!-- Menu Toggle Button (Hamburger) -->
    <button id="menu-toggle" onclick="openSideMenu()" class="fixed top-4 right-4 z-30 bg-gradient-to-br from-purple-500 to-purple-600 text-white p-3 rounded-full shadow-lg hover:scale-110 transition-all duration-300">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
    </button>

    <!-- Main Container -->
    <div class="min-h-screen">

        <!-- Page: Home Dashboard -->
        <section id="page-home">
            <!-- Hero Section with Gradient Background -->
            <div class="mesh-background relative pb-8 pt-6 px-4">
                <!-- Top Controls -->
                <div class="max-w-7xl mx-auto flex justify-end items-center mb-6 pr-20">
                    <!-- Right: User Profile & Dark Mode -->
                    <div class="flex items-center gap-3">
                        <!-- User Profile Section -->
                        <div id="user-section" class="flex items-center gap-2">
                            <!-- Not Logged In - Show Login Button -->
                            <button id="login-button" onclick="window.location.href='/auth/google'" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white px-4 py-2 rounded-full shadow-lg transition-all duration-300 hover:scale-105 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                                <span class="text-sm font-medium">×”×ª×—×‘×¨</span>
                            </button>
                            
                            <!-- Logged In - Show User Menu -->
                            <div id="user-menu" class="hidden relative">
                                <button onclick="toggleUserDropdown()" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white px-4 py-2 rounded-full shadow-lg transition-all duration-300 hover:scale-105 flex items-center gap-2">
                                    <!-- User Avatar Container - will be filled dynamically -->
                                    <div id="user-avatar-container" class="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center overflow-hidden">
                                        <!-- Default SVG icon -->
                                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                        </svg>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-xs opacity-80">×‘×¨×•×š ×”×‘×</div>
                                        <div id="user-name" class="text-sm font-medium"></div>
                                    </div>
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </button>
                                
                                <!-- Dropdown Menu -->
                                <div id="user-dropdown" class="hidden absolute left-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 z-50">
                                    <div class="p-3 border-b border-gray-200 dark:border-gray-700">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white" id="dropdown-user-name"></div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400" id="dropdown-user-email"></div>
                                    </div>
                                    <button onclick="logout()" class="w-full text-right px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-b-xl transition-colors flex items-center gap-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                                        </svg>
                                        ×”×ª× ×ª×§
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Dark Mode Toggle -->
                        <button onclick="toggleDarkMode()" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white p-3 rounded-full shadow-lg transition-all duration-300 hover:scale-110">
                            <svg id="dark-mode-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <!-- Welcome Message & Logo Center -->
                <div class="max-w-7xl mx-auto text-center text-white relative z-10 mb-6 fade-in">
                    <div class="inline-flex items-center gap-2 bg-white/10 backdrop-blur-sm px-6 py-3 rounded-2xl shadow-lg mb-3">
                        <span class="text-4xl moon-float">ğŸŒ™</span>
                        <span class="text-3xl font-bold text-white">Luna</span>
                    </div>
                    <p class="text-sm text-white/80 italic mb-2">âœ¨ Illuminate your business path âœ¨</p>
                    <h1 class="text-xl md:text-2xl font-bold" id="welcome-message">×©×œ×•×, ×‘×¨×•×›×” ×”×©×•×‘×” ×œ-Luna</h1>
                </div>
            </div>
            
            <!-- Main Content Area -->
            <div class="max-w-7xl mx-auto px-4 -mt-6 pb-6">
                
                <!-- Quick Actions Grid - Top priority -->
                <div class="mb-3 fade-in fade-in-delay-1">
                    <h2 class="text-base md:text-lg font-bold text-gray-900 dark:text-white mb-2">×¤×¢×•×œ×•×ª ××”×™×¨×•×ª</h2>
                    
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-3">
                        <!-- Income Entry Card -->
                        <button onclick="switchPage('entry')" class="group bg-white dark:bg-slate-800 rounded-xl shadow-md p-4 md:p-6 text-right card-hover border-2 border-transparent hover:border-purple-500 transition-all">
                            <div class="w-10 h-10 md:w-14 md:h-14 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mb-2 md:mb-3 group-hover:scale-110 transition-transform">
                                <svg class="w-5 h-5 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                </svg>
                            </div>
                            <h3 class="text-sm md:text-lg font-bold text-gray-900 dark:text-white mb-1">×”×›× ×¡×” ×—×“×©×”</h3>
                            <p class="text-xs md:text-sm text-gray-600 dark:text-gray-400">×”×–×Ÿ ×¢×¡×§×”</p>
                        </button>
                        
                        <!-- Leads Management Card -->
                        <button onclick="switchPage('leads')" class="group bg-white dark:bg-slate-800 rounded-xl shadow-md p-4 md:p-6 text-right card-hover border-2 border-transparent hover:border-blue-500 transition-all">
                            <div class="w-10 h-10 md:w-14 md:h-14 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center mb-2 md:mb-3 group-hover:scale-110 transition-transform">
                                <svg class="w-5 h-5 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-sm md:text-lg font-bold text-gray-900 dark:text-white mb-1">× ×™×”×•×œ ×œ×™×“×™×</h3>
                            <p class="text-xs md:text-sm text-gray-600 dark:text-gray-400">×¢×§×•×‘ ××—×¨×™ ×œ×§×•×—×•×ª</p>
                        </button>
                        
                        <!-- Statistics Card -->
                        <button onclick="switchPage('stats')" class="group bg-white dark:bg-slate-800 rounded-xl shadow-md p-4 md:p-6 text-right card-hover border-2 border-transparent hover:border-emerald-500 transition-all">
                            <div class="w-10 h-10 md:w-14 md:h-14 bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl flex items-center justify-center mb-2 md:mb-3 group-hover:scale-110 transition-transform">
                                <svg class="w-5 h-5 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-sm md:text-lg font-bold text-gray-900 dark:text-white mb-1">×¡×˜×˜×™×¡×˜×™×§×•×ª</h3>
                            <p class="text-xs md:text-sm text-gray-600 dark:text-gray-400">×“×•×—×•×ª ×•× ×™×ª×•×—</p>
                        </button>
                        
                        <!-- Business Insights Card -->
                        <button onclick="switchPage('insights')" class="group bg-white dark:bg-slate-800 rounded-xl shadow-md p-4 md:p-6 text-right card-hover border-2 border-transparent hover:border-amber-500 transition-all">
                            <div class="w-10 h-10 md:w-14 md:h-14 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl flex items-center justify-center mb-2 md:mb-3 group-hover:scale-110 transition-transform">
                                <svg class="w-5 h-5 md:w-7 md:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-sm md:text-lg font-bold text-gray-900 dark:text-white mb-1">ğŸ“Š ×ª×•×‘× ×•×ª ×¢×¡×§×™×•×ª</h3>
                            <p class="text-xs md:text-sm text-gray-600 dark:text-gray-400">× ×™×ª×•×— ×•×‘×™×¦×•×¢×™×</p>
                        </button>
                    </div>
                </div>
                
                <!-- Annual Goals Section - Moved before stats -->
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-3 mb-3 fade-in fade-in-delay-2">
                    <h2 class="text-base md:text-lg font-bold text-gray-900 dark:text-white mb-2" id="annual-goals-title">×™×¢×“×™× ×©× ×ª×™×™×</h2>
                    
                    <div class="space-y-2.5">
                        <!-- Income Goal -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <div class="flex items-center gap-2">
                                    <div class="w-7 h-7 bg-gradient-to-br from-emerald-400 to-green-500 rounded-lg flex items-center justify-center">
                                        <svg class="w-3.5 h-3.5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xs md:text-sm font-semibold text-gray-900 dark:text-white">×”×›× ×¡×•×ª</h3>
                                        <p class="text-xs text-gray-600 dark:text-gray-400"><span id="income-goal-current">â‚ª0</span> / <span id="income-goal-target">â‚ª0</span></p>
                                    </div>
                                </div>
                                <p class="text-sm font-bold text-emerald-600 dark:text-emerald-400" id="income-goal-percentage">0%</p>
                            </div>
                            <div class="h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div id="income-goal-bar" class="h-full bg-gradient-to-r from-emerald-400 to-green-500 rounded-full progress-animate" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <!-- Brides Goal -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <div class="flex items-center gap-2">
                                    <div class="w-7 h-7 bg-gradient-to-br from-pink-400 to-rose-500 rounded-lg flex items-center justify-center">
                                        <svg class="w-3.5 h-3.5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xs md:text-sm font-semibold text-gray-900 dark:text-white">×›×œ×•×ª</h3>
                                        <p class="text-xs text-gray-600 dark:text-gray-400"><span id="brides-goal-current">0</span> / <span id="brides-goal-target">0</span></p>
                                    </div>
                                </div>
                                <p class="text-sm font-bold text-pink-600 dark:text-pink-400" id="brides-goal-percentage">0%</p>
                            </div>
                            <div class="h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div id="brides-goal-bar" class="h-full bg-gradient-to-r from-pink-400 to-rose-500 rounded-full progress-animate" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Stats Cards -->
                <div class="grid grid-cols-3 gap-3 fade-in fade-in-delay-3">
                    <!-- Monthly Revenue Card -->
                    <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-3 card-hover">
                        <div class="flex flex-col">
                            <div class="flex items-center justify-between mb-2">
                                <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center">
                                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <p class="text-xs text-gray-600 dark:text-gray-400">×”×›× ×¡×” ×—×•×“×©×™×ª</p>
                            </div>
                            <div class="flex flex-col gap-0.5">
                                <p class="text-xl md:text-2xl font-bold text-gray-900 dark:text-white" id="monthly-revenue">â‚ª0</p>
                                <span class="text-xs font-semibold text-green-600 dark:text-green-400" id="revenue-trend">+0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Active Leads Card -->
                    <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-3 card-hover">
                        <div class="flex flex-col">
                            <div class="flex items-center justify-between mb-2">
                                <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
                                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                    </svg>
                                </div>
                                <p class="text-xs text-gray-600 dark:text-gray-400">×œ×™×“×™× ×¤×¢×™×œ×™×</p>
                            </div>
                            <div class="flex items-baseline gap-1">
                                <p class="text-xl md:text-2xl font-bold text-gray-900 dark:text-white" id="active-leads-count">0</p>
                                <span class="text-xs text-gray-500 dark:text-gray-400">×¤×ª×•×—×™×</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Upcoming Events Card -->
                    <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-3 card-hover">
                        <div class="flex flex-col">
                            <div class="flex items-center justify-between mb-2">
                                <div class="w-8 h-8 bg-gradient-to-br from-emerald-500 to-green-600 rounded-lg flex items-center justify-center">
                                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                </div>
                                <p class="text-xs text-gray-600 dark:text-gray-400">××™×¨×•×¢×™× ×§×¨×•×‘×™×</p>
                            </div>
                            <div class="flex items-baseline gap-1">
                                <p class="text-xl md:text-2xl font-bold text-gray-900 dark:text-white" id="upcoming-events-count">0</p>
                                <span class="text-xs text-gray-500 dark:text-gray-400">×”×©×‘×•×¢</span>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </section>

        <!-- Page: Income Entry -->
        <section id="page-entry" class="hidden main-card p-8 pt-6 max-w-lg mx-auto text-right">
            <!-- Header with Dark Mode Toggle -->
            <div class="relative mb-6">
                <!-- Dark Mode Toggle - Top Right -->
                <button onclick="toggleDarkMode()" class="absolute top-0 right-0 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 p-2 rounded-full shadow-md transition-all duration-300 hover:scale-110 z-10">
                    <svg id="dark-mode-icon-entry" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                
                <!-- Centered Logo -->
                <div class="text-center mb-4">
                    <div class="inline-block">
                        <div class="bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 text-white px-6 py-2 rounded-xl shadow-lg">
                            <span class="text-2xl font-black tracking-tight flex items-center gap-2 justify-center">ğŸŒ™ Luna</span>
                        </div>
                    </div>
                </div>
                
                <!-- Back Button - Small, Left Side -->
                <button onclick="switchPage('home')" class="absolute bottom-0 left-0 group bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 px-3 py-1.5 rounded-lg font-medium text-sm flex items-center gap-1 transition-all duration-300 shadow-sm hover:shadow-md border border-gray-200 dark:border-gray-600">
                    <svg class="w-3.5 h-3.5 group-hover:-translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    <span>×—×–×¨×”</span>
                </button>
            </div>
            <h2 class="text-2xl font-bold mb-6 text-purple-800 dark:text-purple-300 text-center">×”×–× ×ª ×¢×¡×§×” ×—×“×©×”</h2>
            
            <form onsubmit="event.preventDefault(); saveIncome();">
                <input type="text" id="inc-name" placeholder="×©× ×”×œ×§×•×—×” *" required>
                <input type="number" id="inc-amount" placeholder="×¡×›×•× (â‚ª) *" required step="0.01">
                <input type="text" id="inc-service" placeholder="×¡×•×’ ×”×©×™×¨×•×ª (×”×§×œ×“×” ×—×•×¤×©×™×ª)">
                <input type="date" id="inc-date" required>
                
                <select id="inc-payment" class="dark:bg-slate-700 dark:text-white dark:border-slate-600">
                    <option value="××–×•××Ÿ">××–×•××Ÿ</option>
                    <option value="×‘×™×˜">×‘×™×˜ / ×¤×™×™×‘×•×§×¡</option>
                    <option value="×”×¢×‘×¨×”">×”×¢×‘×¨×” ×‘× ×§××™×ª</option>
                </select>
                
                <label class="flex items-center gap-2 p-3 bg-purple-50 rounded-xl mb-4 cursor-pointer">
                    <input type="checkbox" id="inc-isbride" class="w-5 h-5">
                    <span class="font-bold text-purple-900">×¢×¡×§×ª ×›×œ×” ğŸ‘°</span>
                </label>
                
                <button type="submit" id="btn-save" class="w-full bg-purple-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg">
                    ×©××•×¨ ×‘××¡×“ × ×ª×•× ×™×
                </button>
            </form>
        </section>

        <!-- Page: Leads Management -->
        <section id="page-leads" class="hidden pt-6">
            <!-- Header with Dark Mode Toggle -->
            <div class="relative mb-6">
                <!-- Dark Mode Toggle - Top Right -->
                <button onclick="toggleDarkMode()" class="absolute top-0 right-0 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 p-2 rounded-full shadow-md transition-all duration-300 hover:scale-110 z-10">
                    <svg id="dark-mode-icon-leads" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                
                <!-- Centered Logo -->
                <div class="text-center mb-4">
                    <div class="inline-block">
                        <div class="bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 text-white px-6 py-2 rounded-xl shadow-lg">
                            <span class="text-2xl font-black tracking-tight flex items-center gap-2 justify-center">ğŸŒ™ Luna</span>
                        </div>
                    </div>
                </div>
                
                <!-- Back Button - Small, Left Side -->
                <button onclick="switchPage('home')" class="absolute bottom-0 left-0 group bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 px-3 py-1.5 rounded-lg font-medium text-sm flex items-center gap-1 transition-all duration-300 shadow-sm hover:shadow-md border border-gray-200 dark:border-gray-600">
                    <svg class="w-3.5 h-3.5 group-hover:-translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    <span>×—×–×¨×”</span>
                </button>
            </div>
            <div class="flex justify-between items-center mb-6 px-2 text-right">
                <h2 class="text-2xl font-bold text-purple-900 dark:text-purple-300">× ×™×”×•×œ ×œ×™×“×™×</h2>
                <div class="flex gap-2">
                    <!-- Settings Dropdown -->
                    <div class="relative" id="settings-dropdown">
                        <button onclick="toggleSettingsDropdown()" class="bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-xl font-bold transition-all flex items-center gap-2 shadow-sm">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            ×”×’×“×¨×•×ª
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div id="settings-menu" class="hidden absolute left-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 z-50 overflow-hidden">
                            <button onclick="openModal('modal-message-settings'); toggleSettingsDropdown()" class="w-full text-right px-4 py-3 hover:bg-purple-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 transition-colors flex items-center gap-3 border-b border-gray-100 dark:border-gray-700">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                                </svg>
                                <span class="font-medium">×”×’×“×¨×•×ª ×”×•×“×¢×•×ª</span>
                            </button>
                            <button onclick="openModal('modal-timer-settings'); toggleSettingsDropdown()" class="w-full text-right px-4 py-3 hover:bg-purple-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 transition-colors flex items-center gap-3 border-b border-gray-100 dark:border-gray-700">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span class="font-medium">×”×’×“×¨×•×ª ×˜×™×™××¨×™×</span>
                            </button>
                            <button onclick="window.location.href='/contract-editor.html'; toggleSettingsDropdown()" class="w-full text-right px-4 py-3 hover:bg-purple-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 transition-colors flex items-center gap-3">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                                <span class="font-medium">×¢×¨×™×›×ª ×ª×‘× ×™×ª ×—×•×–×”</span>
                            </button>
                        </div>
                    </div>
                    <button onclick="openModal('modal-new-lead')" class="bg-purple-600 hover:bg-purple-700 text-white px-5 py-2 rounded-xl font-bold transition-all shadow-sm flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        ×œ×™×“ ×—×“×©
                    </button>
                </div>
            </div>
            <div id="kanban-board" class="kanban-container text-right"></div>
        </section>

        <!-- Page: Statistics -->
        <section id="page-stats" class="hidden text-right pt-6">
            <!-- Header with Dark Mode Toggle -->
            <div class="relative mb-6">
                <!-- Dark Mode Toggle - Top Right -->
                <button onclick="toggleDarkMode()" class="absolute top-0 right-0 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 p-2 rounded-full shadow-md transition-all duration-300 hover:scale-110 z-10">
                    <svg id="dark-mode-icon-stats" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                
                <!-- Centered Logo -->
                <div class="text-center mb-4">
                    <div class="inline-block">
                        <div class="bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 text-white px-6 py-2 rounded-xl shadow-lg">
                            <span class="text-2xl font-black tracking-tight flex items-center gap-2 justify-center">ğŸŒ™ Luna</span>
                        </div>
                    </div>
                </div>
                
                <!-- Back Button - Small, Left Side -->
                <button onclick="switchPage('home')" class="absolute bottom-0 left-0 group bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 px-3 py-1.5 rounded-lg font-medium text-sm flex items-center gap-1 transition-all duration-300 shadow-sm hover:shadow-md border border-gray-200 dark:border-gray-600">
                    <svg class="w-3.5 h-3.5 group-hover:-translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    <span>×—×–×¨×”</span>
                </button>
            </div>
            <div class="main-card p-6">
                <div class="flex flex-wrap justify-between items-center mb-6 gap-4 border-b border-gray-200 dark:border-gray-700 pb-4">
                    <h2 class="text-2xl font-bold text-purple-800 dark:text-purple-300">×‘×™×¦×•×¢×™× ×•× ×™×”×•×œ</h2>
                    <div class="flex gap-2 flex-wrap">
                        <button onclick="exportToExcel()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-xl font-bold text-sm transition-all shadow-lg hover:shadow-xl">
                            ğŸ“¥ ×”×•×¨×“ ×“×•×— Excel
                        </button>
                        <button onclick="openManageModal()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-xl font-bold transition-all shadow-lg hover:shadow-xl">
                            âš™ï¸ × ×™×”×•×œ ×©×•×¨×•×ª
                        </button>
                        <select id="stats-year-filter" onchange="updateStats()" class="!w-28 !mb-0 font-bold dark:bg-gray-700 dark:text-white dark:border-gray-600"></select>
                        <select id="stats-month-filter" onchange="updateStats()" class="!w-44 !mb-0 font-bold dark:bg-gray-700 dark:text-white dark:border-gray-600"></select>
                    </div>
                </div>
                
                <!-- Summary Cards -->
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8">
                    <div class="bg-gradient-to-br from-purple-600 to-purple-800 p-6 rounded-2xl text-center shadow-lg">
                        <div class="text-purple-200 text-sm font-semibold">×”×›× ×¡×•×ª</div>
                        <div id="sum-total" class="text-3xl font-bold text-white">0</div>
                    </div>
                    <div class="bg-gradient-to-br from-pink-600 to-rose-700 p-6 rounded-2xl text-center shadow-lg">
                        <div class="text-pink-100 text-sm font-semibold">×›×œ×•×ª</div>
                        <div id="sum-brides" class="text-3xl font-bold text-white">0</div>
                    </div>
                    <div class="bg-gradient-to-br from-cyan-600 to-blue-700 p-6 rounded-2xl text-center shadow-lg hidden md:block">
                        <div class="text-cyan-100 text-sm font-semibold">×¢×¡×§××•×ª</div>
                        <div id="sum-count" class="text-3xl font-bold text-white">0</div>
                    </div>
                </div>
                
                <!-- Chart -->
                <div class="h-80">
                    <canvas id="incomeChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Page: Business Insights -->
        <section id="page-insights" class="hidden pt-6">
            <!-- Header with Dark Mode Toggle -->
            <div class="relative mb-6">
                <!-- Dark Mode Toggle - Top Right -->
                <button onclick="toggleDarkMode()" class="absolute top-0 right-0 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 p-2 rounded-full shadow-md transition-all duration-300 hover:scale-110 z-10">
                    <svg id="dark-mode-icon-insights" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                
                <!-- Centered Logo -->
                <div class="text-center mb-4">
                    <div class="inline-block">
                        <div class="bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 text-white px-6 py-2 rounded-xl shadow-lg">
                            <span class="text-2xl font-black tracking-tight flex items-center gap-2 justify-center">ğŸŒ™ Luna</span>
                        </div>
                    </div>
                </div>
                
                <!-- Back Button - Small, Left Side -->
                <button onclick="switchPage('home')" class="absolute bottom-0 left-0 group bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 px-3 py-1.5 rounded-lg font-medium text-sm flex items-center gap-1 transition-all duration-300 shadow-sm hover:shadow-md border border-gray-200 dark:border-gray-600">
                    <svg class="w-3.5 h-3.5 group-hover:-translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    <span>×—×–×¨×”</span>
                </button>
            </div>

            <!-- Page Title -->
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">ğŸ“Š ×ª×•×‘× ×•×ª ×¢×¡×§×™×•×ª</h2>
                <p class="text-sm text-gray-600 dark:text-gray-400">×’×œ×• ××”×™×›×Ÿ ××’×™×¢×™× ×”×œ×§×•×—×•×ª ×©×œ×›×, ××™×œ×• ×¢×¨×•×¦×™× ×× ×™×‘×™× ×”×›× ×¡×” ×•××™×¤×” ××ª× ×™×›×•×œ×™× ×œ×”×©×ª×¤×¨</p>
            </div>

            <!-- Filters -->
            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-4 mb-6">
                <div class="flex flex-wrap gap-3 items-center">
                    <div class="flex-1 min-w-[200px]">
                        <label class="block text-xs font-bold text-gray-700 dark:text-gray-300 mb-1">×˜×•×•×— ×ª××¨×™×›×™×</label>
                        <select id="insights-period" onchange="InsightsView.refresh()" class="w-full p-2 border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-xl text-sm">
                            <option value="month">×—×•×“×© ××—×¨×•×Ÿ</option>
                            <option value="3months">3 ×—×•×“×©×™× ××—×¨×•× ×™×</option>
                            <option value="6months">6 ×—×•×“×©×™× ××—×¨×•× ×™×</option>
                            <option value="year" selected>×©× ×” ××—×¨×•× ×”</option>
                            <option value="all">×›×œ ×”×–××Ÿ</option>
                        </select>
                    </div>
                    <div class="flex-1 min-w-[200px]">
                        <label class="block text-xs font-bold text-gray-700 dark:text-gray-300 mb-1">××§×•×¨ (××•×¤×¦×™×•× ×œ×™)</label>
                        <select id="insights-source-filter" onchange="InsightsView.refresh()" class="w-full p-2 border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-xl text-sm">
                            <option value="all">×”×›×œ</option>
                            <!-- Will be populated dynamically -->
                        </select>
                    </div>
                </div>
            </div>

            <!-- Section 1: High-Level Overview (KPI Cards) -->
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <!-- Total Leads Card -->
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 text-center">
                    <div class="flex items-center justify-center gap-2 mb-2">
                        <h3 class="text-sm font-bold text-gray-700 dark:text-gray-300">×¡×”"×› ×œ×™×“×™×</h3>
                        <button onclick="showTooltip('tooltip-total-leads')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="kpi-total-leads" class="text-4xl font-bold text-purple-600 dark:text-purple-400">0</div>
                    <div id="tooltip-total-leads" class="hidden text-xs text-gray-500 dark:text-gray-400 mt-2">××¡×¤×¨ ×”×œ×™×“×™× ×©×”×ª×§×‘×œ×• ×‘×ª×§×•×¤×” ×©× ×‘×—×¨×”</div>
                </div>

                <!-- Conversion Rate Card -->
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 text-center">
                    <div class="flex items-center justify-center gap-2 mb-2">
                        <h3 class="text-sm font-bold text-gray-700 dark:text-gray-300">××—×•×– ×”××¨×”</h3>
                        <button onclick="showTooltip('tooltip-conversion')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="kpi-conversion-rate" class="text-4xl font-bold text-green-600 dark:text-green-400">0%</div>
                    <div id="tooltip-conversion" class="hidden text-xs text-gray-500 dark:text-gray-400 mt-2">××—×•×– ×”×œ×™×“×™× ×©×”×¤×›×• ×œ×œ×§×•×—×•×ª ××©×œ××™×</div>
                </div>

                <!-- Total Revenue Card -->
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 text-center">
                    <div class="flex items-center justify-center gap-2 mb-2">
                        <h3 class="text-sm font-bold text-gray-700 dark:text-gray-300">×”×›× ×¡×•×ª ×›×•×œ×œ×•×ª</h3>
                        <button onclick="showTooltip('tooltip-revenue')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="kpi-total-revenue" class="text-4xl font-bold text-blue-600 dark:text-blue-400">0 â‚ª</div>
                    <div id="tooltip-revenue" class="hidden text-xs text-gray-500 dark:text-gray-400 mt-2">×¡×›×•× ×”×”×›× ×¡×•×ª ××¢×¡×§××•×ª ×©× ×¡×’×¨×•</div>
                </div>

                <!-- Average Time to Close Card -->
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 text-center">
                    <div class="flex items-center justify-center gap-2 mb-2">
                        <h3 class="text-sm font-bold text-gray-700 dark:text-gray-300">×–××Ÿ ×××•×¦×¢ ×œ×¡×’×™×¨×”</h3>
                        <button onclick="showTooltip('tooltip-time-to-close')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="kpi-avg-time" class="text-4xl font-bold text-amber-600 dark:text-amber-400">0</div>
                    <div class="text-xs text-gray-500 dark:text-gray-400">×™××™×</div>
                    <div id="tooltip-time-to-close" class="hidden text-xs text-gray-500 dark:text-gray-400 mt-2">×›××” ×–××Ÿ ×‘×××•×¦×¢ ×œ×•×§×— ×¢×“ ×©×œ×™×“ ×”×•×¤×š ×œ×œ×§×•×—</div>
                </div>
            </div>

            <!-- Section 2: Marketing & Channel Insights -->
            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 mb-6">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">ğŸ“¢ × ×™×ª×•×— ×¢×¨×•×¦×™ ×©×™×•×•×§</h3>
                
                <div class="grid lg:grid-cols-2 gap-6">
                    <!-- Lead Sources Distribution -->
                    <div>
                        <h4 class="text-sm font-bold text-gray-700 dark:text-gray-300 mb-3">×”×ª×¤×œ×’×•×ª ×œ×™×“×™× ×œ×¤×™ ××§×•×¨</h4>
                        <div class="h-64">
                            <canvas id="chart-sources-pie"></canvas>
                        </div>
                        <p id="sources-insight" class="text-sm text-gray-600 dark:text-gray-400 mt-3 text-center italic"></p>
                    </div>

                    <!-- Conversion Rate by Source -->
                    <div>
                        <h4 class="text-sm font-bold text-gray-700 dark:text-gray-300 mb-3">××—×•×– ×”××¨×” ×œ×¤×™ ××§×•×¨</h4>
                        <div class="h-64">
                            <canvas id="chart-conversion-bar"></canvas>
                        </div>
                        <p id="conversion-insight" class="text-sm text-gray-600 dark:text-gray-400 mt-3 text-center italic"></p>
                    </div>
                </div>

                <!-- Revenue by Source Table -->
                <div class="mt-6">
                    <h4 class="text-sm font-bold text-gray-700 dark:text-gray-300 mb-3">×”×›× ×¡×•×ª ×œ×¤×™ ××§×•×¨</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b-2 border-gray-200 dark:border-gray-700">
                                    <th class="text-right p-3 font-bold">××§×•×¨</th>
                                    <th class="text-center p-3 font-bold">×œ×™×“×™×</th>
                                    <th class="text-center p-3 font-bold">× ×¡×’×¨×•</th>
                                    <th class="text-center p-3 font-bold">×”××¨×”</th>
                                    <th class="text-right p-3 font-bold">×”×›× ×¡×•×ª</th>
                                    <th class="text-right p-3 font-bold">×××•×¦×¢ ×œ×¢×¡×§×”</th>
                                </tr>
                            </thead>
                            <tbody id="revenue-by-source-table">
                                <!-- Will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Section 3: Process & Performance Insights -->
            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 mb-6">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">ğŸ“ˆ ×‘×™×¦×•×¢×™× ×•×ª×”×œ×™×š ××›×™×¨×”</h3>
                
                <div class="grid lg:grid-cols-2 gap-6">
                    <!-- Lead Drop-Off Funnel -->
                    <div>
                        <h4 class="text-sm font-bold text-gray-700 dark:text-gray-300 mb-3">××©×¤×š ×”××¨×” - ×”×™×›×Ÿ ×œ×™×“×™× × ×•×¤×œ×™×?</h4>
                        <div class="space-y-3">
                            <div class="funnel-stage" data-stage="new">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-bold">×œ×™×“ ×—×“×©</span>
                                    <span class="text-sm font-bold" id="funnel-new-count">0</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-8">
                                    <div id="funnel-new-bar" class="bg-purple-600 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold" style="width: 100%">100%</div>
                                </div>
                            </div>

                            <div class="funnel-stage" data-stage="in-progress">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-bold">×‘×ª×”×œ×™×š</span>
                                    <span class="text-sm font-bold" id="funnel-progress-count">0</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-8">
                                    <div id="funnel-progress-bar" class="bg-blue-600 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold" style="width: 0%"></div>
                                </div>
                            </div>

                            <div class="funnel-stage" data-stage="contract-sent">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-bold">×—×•×–×” × ×©×œ×—</span>
                                    <span class="text-sm font-bold" id="funnel-contract-count">0</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-8">
                                    <div id="funnel-contract-bar" class="bg-indigo-600 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold" style="width: 0%"></div>
                                </div>
                            </div>

                            <div class="funnel-stage" data-stage="closed">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-bold">âœ… × ×¡×’×¨</span>
                                    <span class="text-sm font-bold" id="funnel-closed-count">0</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-8">
                                    <div id="funnel-closed-bar" class="bg-green-600 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold" style="width: 0%"></div>
                                </div>
                            </div>

                            <div class="funnel-stage" data-stage="not-closed">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-bold">âŒ ×œ× × ×¡×’×¨</span>
                                    <span class="text-sm font-bold" id="funnel-not-closed-count">0</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-8">
                                    <div id="funnel-not-closed-bar" class="bg-red-600 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        <p id="funnel-insight" class="text-sm text-gray-600 dark:text-gray-400 mt-4 text-center italic"></p>
                    </div>

                    <!-- Average Deal Size -->
                    <div>
                        <h4 class="text-sm font-bold text-gray-700 dark:text-gray-300 mb-3">×’×•×“×œ ×¢×¡×§×” ×××•×¦×¢</h4>
                        <div class="h-64">
                            <canvas id="chart-deal-size"></canvas>
                        </div>
                        <p id="deal-size-insight" class="text-sm text-gray-600 dark:text-gray-400 mt-3 text-center italic"></p>
                    </div>
                </div>
            </div>

            <!-- Empty State (shown when no data) -->
            <div id="insights-empty-state" class="hidden bg-white dark:bg-slate-800 rounded-xl shadow-md p-12 text-center">
                <svg class="w-24 h-24 mx-auto text-gray-300 dark:text-gray-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                <h3 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">××™×Ÿ ××¡×¤×™×§ × ×ª×•× ×™×</h3>
                <p class="text-gray-600 dark:text-gray-400">×”×ª×—×™×œ×• ×œ×”×•×¡×™×£ ×œ×™×“×™× ×•×œ×¡×’×•×¨ ×¢×¡×§××•×ª ×›×“×™ ×œ×¨××•×ª ×ª×•×‘× ×•×ª</p>
            </div>
        </section>

        <!-- Page: Contracts (Coming Soon) -->
        <section id="page-contracts" class="hidden pt-6">
            <div class="max-w-4xl mx-auto">
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-12 text-center">
                    <div class="mb-6">
                        <svg class="w-32 h-32 mx-auto text-purple-300 dark:text-purple-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">âœ¨ ××¢×¨×›×ª ×—×•×–×™×</h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400 mb-2">×ª×›×•× ×” ×–×• × ××¦××ª ×‘×¤×™×ª×•×—</p>
                    <p class="text-sm text-gray-500 dark:text-gray-500">×‘×§×¨×•×‘ ×ª×•×›×œ×™ ×œ× ×”×œ ×—×•×–×™× ×“×™×’×™×˜×œ×™×™×, ×œ×©×œ×•×— ×œ×—×ª×™××” ×•×œ×¢×§×•×‘ ××—×¨×™ ×¡×˜×˜×•×¡</p>
                    <div class="mt-8">
                        <button onclick="switchPage('home')" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-xl font-bold transition-all">
                            ×—×–×¨×” ×œ×“×£ ×”×‘×™×ª
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Page: Social (Coming Soon) -->
        <section id="page-social" class="hidden pt-6">
            <div class="max-w-4xl mx-auto">
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md p-12 text-center">
                    <div class="mb-6">
                        <svg class="w-32 h-32 mx-auto text-blue-300 dark:text-blue-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                        </svg>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">âœ¨ × ×™×”×•×œ ×¡×•×©×™××œ ××“×™×”</h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400 mb-2">×ª×›×•× ×” ×–×• × ××¦××ª ×‘×¤×™×ª×•×—</p>
                    <p class="text-sm text-gray-500 dark:text-gray-500">×‘×§×¨×•×‘ ×ª×•×›×œ×™ ×œ× ×”×œ ×¤×•×¡×˜×™×, ×ª×•×›×Ÿ ×•××™× ×˜×¨××§×¦×™×•×ª ×™×©×™×¨×•×ª ××”××¢×¨×›×ª</p>
                    <div class="mt-8">
                        <button onclick="switchPage('home')" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-bold transition-all">
                            ×—×–×¨×” ×œ×“×£ ×”×‘×™×ª
                        </button>
                    </div>
                </div>
            </div>
        </section>
    
    </div>
    <!-- End Main Container -->

    <!-- Modal: New Lead -->
    <div id="modal-new-lead" class="modal">
        <div class="bg-white p-6 rounded-3xl w-full max-w-md shadow-2xl text-right overflow-y-auto max-h-[90vh]">
            <h3 class="text-xl font-bold mb-4 text-purple-800 text-center">×”×•×¡×¤×ª ×œ×™×“ ×—×“×©</h3>
            
            <input type="text" id="lead-name" placeholder="×©× ×¤×¨×˜×™ *">
            <input type="text" id="lead-last-name" placeholder="×©× ××©×¤×—×” *">
            <input type="tel" id="lead-phone" placeholder="××¡×¤×¨ ×˜×œ×¤×•×Ÿ *">
            
            <select id="lead-source" class="mb-4 dark:bg-slate-700 dark:text-white dark:border-slate-600">
                <option value="">×‘×—×¨×™ ××§×•×¨ ×”×’×¢×”</option>
                <option value="××™× ×¡×˜×’×¨×">××™× ×¡×˜×’×¨×</option>
                <option value="×¤×™×™×¡×‘×•×§">×¤×™×™×¡×‘×•×§</option>
                <option value="×¤×” ×œ××•×–×Ÿ">×¤×” ×œ××•×–×Ÿ</option>
                <option value="×œ×§×•×—×” ×—×•×–×¨×ª">×œ×§×•×—×” ×—×•×–×¨×ª</option>
                <option value="××—×¨">××—×¨</option>
            </select>
            
            <input type="text" id="lead-service" placeholder="×©×™×¨×•×ª ××‘×•×§×©">
            <input type="date" id="lead-event-date">
            <input type="text" id="lead-location" placeholder="××™×§×•× / ××•×œ×">
            
            <label class="flex items-center gap-2 p-3 bg-pink-50 dark:bg-pink-900/30 dark:border dark:border-pink-700 rounded-xl mb-4 cursor-pointer">
                <input type="checkbox" id="lead-is-bride" class="w-5 h-5">
                <span class="font-bold dark:text-pink-200">×–×• ×›×œ×” ğŸ‘°</span>
            </label>
            
            <div class="flex gap-2">
                <button onclick="addLead()" id="btn-save-lead" class="flex-1 bg-purple-600 text-white py-3 rounded-xl font-bold">
                    ×©××•×¨ ×œ×™×“
                </button>
                <button onclick="closeModal('modal-new-lead')" class="flex-1 bg-gray-100 text-gray-400 py-3 rounded-xl font-bold">
                    ×‘×™×˜×•×œ
                </button>
            </div>
        </div>
    </div>
    <!-- Modal: View Lead Details (OLD - will be replaced by LeadProfile) -->
    <div id="modal-view-lead" class="modal" style="display: none;">
        <div class="bg-white p-8 rounded-3xl w-full max-w-sm shadow-2xl text-right">
            <div class="mb-4">
                <h3 id="view-name" class="text-2xl font-bold text-purple-800"></h3>
                <span id="view-tag-bride" class="hidden text-pink-500 font-bold text-sm">ğŸ‘° ×œ×§×•×—×ª ×›×œ×”</span>
            </div>
            
            <div class="space-y-3 text-sm border-t pt-4">
                <p><b>×˜×œ×¤×•×Ÿ:</b> <span id="view-phone"></span></p>
                <p><b>××§×•×¨ ×”×’×¢×”:</b> <span id="view-source"></span></p>
                <p><b>×©×™×¨×•×ª:</b> <span id="view-service"></span></p>
                <p><b>×ª××¨×™×š ××™×¨×•×¢:</b> <span id="view-date"></span></p>
                <p><b>××™×§×•×:</b> <span id="view-location"></span></p>
            </div>
            
            <div class="mt-8 flex flex-col gap-2">
                <a id="view-wa-link" target="_blank" class="w-full bg-green-500 text-white py-3 rounded-xl font-bold text-center">
                    ×©×œ×— WhatsApp
                </a>
                <button onclick="closeModal('modal-view-lead')" class="text-gray-400 font-bold py-2">
                    ×¡×’×•×¨
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal: Lead Profile (Enhanced) -->
    <div id="modal-lead-profile" class="modal">
        <!-- Content will be dynamically generated by LeadProfile.render() -->
    </div>

    <!-- Modal: WhatsApp Confirmation -->
    <div id="modal-whatsapp-confirm" class="modal" onclick="if(event.target === this) WhatsAppAutomation.skipMessage()">
        <div class="bg-white p-6 rounded-2xl w-full max-w-md shadow-2xl text-right max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-4">
                <div class="text-5xl mb-3">ğŸ’¬</div>
                <h3 class="text-xl font-bold text-gray-800">×©×œ×™×—×ª ×”×•×“×¢×ª WhatsApp</h3>
            </div>
            
            <!-- Additional fields for contract stage -->
            <!-- In-Process Fields (Proposed Price) -->
            <div id="in-process-fields" class="hidden mb-4 space-y-3">
                <div class="bg-green-50 dark:bg-green-900/20 rounded-xl p-4 border border-green-200 dark:border-green-700">
                    <div class="font-bold text-sm text-gray-700 dark:text-gray-200 mb-3">ğŸ’° ××—×™×¨ ××•×¦×¢ ×œ×¢×¡×§×”</div>
                    <div class="mb-3">
                        <label class="block text-sm font-bold text-gray-700 dark:text-gray-200 mb-2">××—×™×¨ ××•×¦×¢ ×œ×œ×§×•×—×”:</label>
                        <input type="number" id="inprocess-proposedPrice" placeholder="××—×™×¨ ××•×¦×¢ (â‚ª)" class="w-full p-2 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-sm">
                        <p class="text-xs text-gray-600 dark:text-gray-400 mt-2">×–×” ×”××—×™×¨ ×©×™×•×¤×™×¢ ×‘×—×•×–×” ×‘×©×œ×‘ ×”×‘×</p>
                    </div>
                </div>
            </div>
            
            <div id="contract-additional-fields" class="hidden mb-4 space-y-3">
                <div class="bg-blue-50 rounded-xl p-4 border border-blue-200">
                    <div class="font-bold text-sm text-gray-700 mb-3">ğŸ“‹ ×¤×¨×˜×™× × ×•×¡×¤×™× ×œ×—×•×–×”</div>
                    
                    <!-- Proposed Deposit -->
                    <div class="mb-3">
                        <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ’µ ××§×“××” ×¢×§×¨×•× ×™×ª (×ª×•×¤×™×¢ ×‘×—×•×–×”):</label>
                        <input type="number" id="contract-proposedDeposit" placeholder="××§×“××” ××•×¦×¢×ª (â‚ª)" 
                               class="w-full p-2 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg text-sm"
                               onchange="WhatsAppAutomation.saveProposedDeposit()">
                        <p class="text-xs text-gray-500 mt-1">âš ï¸ ×–×”×• ×¢×¨×š ×¢×§×¨×•× ×™ ×‘×œ×‘×“ - ×”×ª×©×œ×•× ×‘×¤×•×¢×œ ×™×•×–×Ÿ ×‘×©×œ×‘ "×¡×’×•×¨×”"</p>
                    </div>
                    
                    <!-- Escort Type Selection -->
                    <div class="mb-3">
                        <label class="block text-sm font-bold text-gray-700 mb-2">×œ×™×•×•×™:</label>
                        <select id="contract-escortType" class="w-full p-2 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg text-sm" onchange="toggleEscortPrice()">
                            <option value="none">×œ×œ× ×œ×™×•×•×™</option>
                            <option value="short">×œ×™×•×•×™ ×§×¦×¨</option>
                            <option value="long">×œ×™×•×•×™ ××¨×•×š</option>
                        </select>
                    </div>
                    
                    <div id="escort-price-field" class="hidden mb-3">
                        <input type="number" id="contract-escortPrice" placeholder="××—×™×¨ ×œ×™×•×•×™ (â‚ª)" class="w-full p-2 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg text-sm">
                    </div>
                    
                    <!-- Bridesmaids Section -->
                    <div class="mb-3">
                        <label class="block text-sm font-bold text-gray-700 mb-2">××œ×•×•×ª:</label>
                        <input type="number" id="contract-bridesmaidsCount" placeholder="×›××•×ª ××œ×•×•×ª (0 ×× ××™×Ÿ)" min="0" class="w-full p-2 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg text-sm" onchange="updateBridesmaidsFields()">
                    </div>
                    
                    <div id="bridesmaids-list" class="space-y-2">
                        <!-- Dynamic bridesmaid fields will be inserted here -->
                    </div>
                </div>
            </div>
            

            <div id="whatsapp-confirm-message" class="bg-gray-50 rounded-xl p-4 mb-4 text-sm font-mono whitespace-pre-wrap border border-gray-200 max-h-48 overflow-y-auto">
                <!-- Message preview will be inserted here -->
            </div>
            
            <div class="text-xs text-gray-500 mb-4 text-center">
                ğŸ“± ×”×”×•×“×¢×” ×ª×™×©×œ×— ×‘-WhatsApp ×¢×›×©×™×•
            </div>
            
            <!-- Preview and Send buttons for contract stage -->
            <div id="contract-actions" class="hidden mb-3">
                <button 
                    onclick="WhatsAppAutomation.previewContractHTML()" 
                    class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold transition-all mb-2">
                    ğŸ” ×‘×“×™×§×ª × ×ª×•× ×™× (HTML)
                </button>
                <button 
                    onclick="WhatsAppAutomation.previewContract()" 
                    class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-xl font-bold transition-all mb-2">
                    ğŸ“„ ×™×¦×™×¨×ª PDF ××œ×
                </button>
            </div>
            
            <div class="flex gap-3">
                <button 
                    onclick="WhatsAppAutomation.sendConfirmed()" 
                    class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold transition-all">
                    âœ“ ×©×œ×— ×¢×›×©×™×•
                </button>
                <button 
                    onclick="WhatsAppAutomation.skipMessage()" 
                    class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-bold transition-all">
                    âœ— ×“×œ×’
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Contract Preview -->
    <div id="modal-contract-preview" class="modal" onclick="if(event.target === this) closeModal('modal-contract-preview')">
        <div class="bg-white p-6 rounded-2xl w-full max-w-4xl shadow-2xl text-right max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4 pb-4 border-b">
                <h3 class="text-xl font-bold text-gray-800">ğŸ‘ï¸ ×ª×¦×•×’×” ××§×“×™××” - ×—×•×–×”</h3>
                <button onclick="closeModal('modal-contract-preview')" class="text-3xl text-gray-400 hover:text-gray-600">&times;</button>
            </div>
            
            <div class="flex-1 overflow-auto mb-4">
                <iframe id="contract-preview-frame" class="w-full h-full min-h-[600px] border-2 border-gray-200 rounded-lg"></iframe>
            </div>
            
            <div class="flex gap-3">
                <button 
                    onclick="WhatsAppAutomation.confirmContractSend()" 
                    class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold transition-all">
                    âœ“ ××©×¨ ×•×©×œ×—
                </button>
                <button 
                    onclick="closeModal('modal-contract-preview')" 
                    class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-bold transition-all">
                    ×—×–×•×¨
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Set Price (In-Process Stage) -->
    <div id="modal-set-price" class="modal" onclick="if(event.target === this) StageManager.skipPrice()">
        <div class="bg-white p-6 rounded-2xl w-full max-w-md shadow-2xl text-right">
            <div class="text-center mb-4">
                <div class="text-5xl mb-3">ğŸ’°</div>
                <h3 class="text-xl font-bold text-gray-800">×”×–× ×ª ××—×™×¨</h3>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">××—×™×¨ ××•×¦×¢ ×œ×œ×§×•×—×” (â‚ª):</label>
                <input type="number" id="price-input" placeholder="×œ×“×•×’××”: 3500" class="w-full p-3 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-xl text-lg" min="0">
            </div>
            
            <div class="flex gap-3">
                <button 
                    onclick="StageManager.confirmPrice()" 
                    class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-xl font-bold transition-all">
                    âœ“ ××©×¨
                </button>
                <button 
                    onclick="StageManager.skipPrice()" 
                    class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-bold transition-all">
                    ×“×œ×’ (×™×™×©××¨ 0)
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Deal Closed (Deposit Recording) -->
    <div id="modal-deal-closed" class="modal" onclick="if(event.target === this) StageManager.skipDealClosed()">
        <div class="bg-white p-6 rounded-2xl w-full max-w-md shadow-2xl text-right">
            <div class="text-center mb-4">
                <div class="text-5xl mb-3">ğŸ¤</div>
                <h3 class="text-xl font-bold text-gray-800">×¢×¡×§×” × ×¡×’×¨×”!</h3>
                <p class="text-sm text-gray-600 mt-2">×‘×•××™ × ×¨×©×•× ××ª ×”××§×“××” ×©×©×•×œ××”</p>
            </div>
            
            <div class="bg-purple-50 rounded-xl p-4 mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm text-gray-600">×¡×”"×› ××—×™×¨ ×—×•×–×”:</span>
                    <span id="closed-totalPrice" class="text-lg font-bold text-purple-700">0 â‚ª</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">××§×“××” ×¢×§×¨×•× ×™×ª ×‘×—×•×–×”:</span>
                    <span id="closed-proposedDeposit" class="text-sm font-bold text-gray-600">0 â‚ª</span>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ’° ××§×“××” ×©×©×•×œ××” ×‘×¤×•×¢×œ (â‚ª):</label>
                <input type="number" id="closed-actualDeposit" placeholder="×›××” ×©×•×œ×?" class="w-full p-3 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-xl text-lg" min="0">
                <p class="text-xs text-gray-500 mt-1">×–×” ×”×¡×›×•× ×©×‘×××ª ×§×™×‘×œ×ª ×›××§×“××”</p>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ’³ ×××¦×¢×™ ×ª×©×œ×•×:</label>
                <select id="closed-paymentMethod" class="w-full p-3 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-xl text-lg">
                    <option value="××–×•××Ÿ">××–×•××Ÿ</option>
                    <option value="×‘×™×˜">×‘×™×˜ / ×¤×™×™×‘×•×§×¡</option>
                    <option value="×”×¢×‘×¨×”">×”×¢×‘×¨×” ×‘× ×§××™×ª</option>
                </select>
            </div>
            
            <div class="flex gap-3">
                <button 
                    onclick="StageManager.confirmDealClosed()" 
                    class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold transition-all">
                    âœ“ ×©××•×¨ ××§×“××”
                </button>
                <button 
                    onclick="StageManager.skipDealClosed()" 
                    class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-bold transition-all">
                    ×“×œ×’
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Set Calendar Date (After Deal Closed) -->
    <div id="modal-calendar-date" class="modal" onclick="if(event.target === this) StageManager.skipCalendarDate()">
        <div class="bg-white p-6 rounded-2xl w-full max-w-md shadow-2xl text-right" style="max-height: 90vh; overflow-y: auto;">
            <div class="text-center mb-4">
                <div class="text-5xl mb-3">ğŸ“…</div>
                <h3 class="text-xl font-bold text-gray-800">×§×‘×™×¢×ª ×ª××¨×™×š ×‘×™×•××Ÿ</h3>
                <p class="text-sm text-gray-600 mt-2">×‘×•××™ × ×§×‘×¢ ××ª ×”××™×¨×•×¢ ×‘×™×•××Ÿ</p>
            </div>
            
            <div class="bg-blue-50 rounded-xl p-4 mb-4">
                <div class="mb-2">
                    <span class="text-sm font-bold text-gray-700">ğŸ‘° ×©× ×”×œ×§×•×—×”:</span>
                    <span id="calendar-clientName" class="text-sm text-gray-600 mr-2">-</span>
                </div>
                <div>
                    <span class="text-sm font-bold text-gray-700">ğŸ“† ×ª××¨×™×š ×”××™×¨×•×¢:</span>
                    <span id="calendar-eventDate" class="text-sm text-gray-600 mr-2">-</span>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ• ×©×¢×ª ×”×”×ª×—×œ×”:</label>
                <input 
                    type="time" 
                    id="calendar-startTime" 
                    class="w-full p-3 border-2 border-gray-300 rounded-xl text-lg text-center" 
                    value="09:00">
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">â±ï¸ ××©×š ×”×©×™×¨×•×ª (×©×¢×•×ª):</label>
                <input 
                    type="number" 
                    id="calendar-duration" 
                    class="w-full p-3 border-2 border-gray-300 rounded-xl text-lg text-center" 
                    value="3"
                    min="0.5"
                    max="12"
                    step="0.5">
                <p class="text-xs text-gray-500 mt-1">×›××” ×–××Ÿ ×”×¢×‘×•×“×” ×œ×•×§×—×ª?</p>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ“ ××™×§×•×:</label>
                <input 
                    type="text" 
                    id="calendar-location" 
                    placeholder="×”×™×›×Ÿ ×”××™×¨×•×¢?"
                    class="w-full p-3 border-2 border-gray-300 rounded-xl text-lg">
                <p class="text-xs text-gray-500 mt-1">×›×ª×•×‘×ª ××“×•×™×§×ª ××• ×©× ××•×œ×</p>
            </div>
            
            <div id="escort-time-section" class="mb-4" style="display: none;">
                <div class="bg-purple-50 p-4 rounded-xl border-2 border-purple-200">
                    <h4 class="font-semibold text-purple-800 mb-3 text-center">ğŸ’ƒ ×œ×™×•×•×™ ×œ××™×¨×•×¢</h4>
                    <div class="mb-3">
                        <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ• ×©×¢×ª ×”×ª×—×œ×ª ×œ×™×•×•×™:</label>
                        <input 
                            type="time" 
                            id="calendar-escortTime" 
                            class="w-full p-3 border-2 border-purple-300 rounded-xl text-lg text-center" 
                            value="18:00">
                    </div>
                    <div class="mb-3">
                        <label class="block text-sm font-bold text-gray-700 mb-2">â±ï¸ ××©×š ×”×œ×™×•×•×™ (×©×¢×•×ª):</label>
                        <input 
                            type="number" 
                            id="calendar-escortDuration" 
                            class="w-full p-3 border-2 border-purple-300 rounded-xl text-lg text-center" 
                            value="4"
                            min="1"
                            max="12"
                            step="0.5">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ“ ××™×§×•× ×œ×™×•×•×™:</label>
                        <input 
                            type="text" 
                            id="calendar-escortLocation" 
                            placeholder="××™×§×•× ×”×œ×™×•×•×™ (×× ×©×•× ×” ××”×©×™×¨×•×ª ×”×¨××©×™)"
                            class="w-full p-3 border-2 border-purple-300 rounded-xl text-sm">
                        <p class="text-xs text-gray-500 mt-1">×× ×¨×™×§ - ×™×•×©×ª××© ××•×ª×• ××™×§×•×</p>
                    </div>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ“ ×”×¢×¨×•×ª × ×•×¡×¤×•×ª (××•×¤×¦×™×•× ×œ×™):</label>
                <textarea 
                    id="calendar-notes" 
                    placeholder="×”×¢×¨×•×ª ×—×©×•×‘×•×ª..."
                    rows="2"
                    class="w-full p-3 border-2 border-gray-300 rounded-xl text-sm"></textarea>
            </div>
            
            <div class="border-t-2 border-gray-200 pt-4 mt-4">
                <h4 class="font-bold text-gray-800 mb-3 text-center">ğŸ“… ×©××™×¨×” ×‘×™×•××Ÿ</h4>
                <div id="calendar-buttons-container" class="space-y-2">
                    <!-- Buttons will be added dynamically -->
                </div>
            </div>
            
            <div class="border-t-2 border-gray-200 pt-4 mt-4">
                <h4 class="font-bold text-gray-800 mb-3 text-center">ğŸ’¬ ×”×•×“×¢×ª WhatsApp</h4>
                <p class="text-xs text-gray-500 mb-2 text-center">× ×™×ª×Ÿ ×œ×¢×¨×•×š ××ª ×”×”×•×“×¢×” ×œ×¤× ×™ ×”×©×œ×™×—×”</p>
                <textarea 
                    id="whatsapp-message-text" 
                    rows="6"
                    class="w-full p-3 border-2 border-gray-300 rounded-xl text-sm mb-3 font-mono"
                    placeholder="×”×”×•×“×¢×” ×ª×™×˜×¢×Ÿ ××•×˜×•××˜×™×ª..."></textarea>
                <button 
                    onclick="StageManager.sendWhatsAppMessage()" 
                    class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold transition-all flex items-center justify-center gap-2">
                    <span>ğŸ“¤</span>
                    <span>×©×œ×— ×‘-WhatsApp</span>
                </button>
            </div>
            
            <div class="mt-4">
                <button 
                    onclick="StageManager.finishCalendarFlow()" 
                    class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-bold transition-all">
                    âœ… ×¡×™×•×
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Event Completed (Income Calculation) -->
    <div id="modal-event-completed" class="modal" onclick="if(event.target === this) StageManager.skipEventCompleted()">
        <div class="bg-white p-6 rounded-2xl w-full max-w-md shadow-2xl text-right">
            <div class="text-center mb-4">
                <div class="text-5xl mb-3">ğŸ‰</div>
                <h3 class="text-xl font-bold text-gray-800">×”××™×¨×•×¢ ×”×•×©×œ×!</h3>
                <p class="text-sm text-gray-600 mt-2">×¡×™×›×•× ×”×”×›× ×¡×” ××”××™×¨×•×¢</p>
            </div>
            
            <div class="bg-purple-50 rounded-xl p-4 mb-4 space-y-2">
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">×¡×”"×› ××—×™×¨ ×—×•×–×”:</span>
                    <span id="completed-totalPrice" class="text-lg font-bold text-purple-700">0 â‚ª</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">ğŸ’³ ××§×“××” ×©×©×•×œ××”:</span>
                    <span id="completed-depositPaid" class="text-lg font-bold text-orange-600">0 â‚ª</span>
                </div>
                <div class="flex justify-between items-center mt-2 pt-2 border-t">
                    <span class="text-sm text-gray-600">ğŸ“‹ ×™×ª×¨×” ×œ×ª×©×œ×•×:</span>
                    <span id="completed-remainingBalance" class="text-lg font-bold text-gray-600">0 â‚ª</span>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ’µ ×ª×©×œ×•× ×©×©×•×œ× ×‘×™×•× ×”××™×¨×•×¢ (â‚ª):</label>
                <input 
                    type="number" 
                    id="completed-eventPayment" 
                    placeholder="×›××” ×©×•×œ× ×‘××™×¨×•×¢?"
                    class="w-full p-3 border-2 border-green-300 rounded-xl text-lg font-bold text-center" 
                    min="0"
                    onchange="StageManager.updateIncomeCalculation()">
                <p class="text-xs text-gray-500 mt-1">× ×™×ª×Ÿ ×œ×©× ×•×ª ××ª ×”×¡×›×•× ×‘××™×“×ª ×”×¦×•×¨×š</p>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ’³ ×××¦×¢×™ ×ª×©×œ×•× (×‘×™×•× ×”××™×¨×•×¢):</label>
                <select id="completed-paymentMethod" class="w-full p-3 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-xl text-lg">
                    <option value="××–×•××Ÿ">××–×•××Ÿ</option>
                    <option value="×‘×™×˜">×‘×™×˜ / ×¤×™×™×‘×•×§×¡</option>
                    <option value="×”×¢×‘×¨×”">×”×¢×‘×¨×” ×‘× ×§××™×ª</option>
                </select>
            </div>
            
            <div class="bg-green-50 rounded-xl p-3 mb-4">
                <div class="flex justify-between items-center">
                    <span class="text-base font-bold text-gray-700">ğŸ’° ×¡×”"×› ×”×›× ×¡×”:</span>
                    <span id="completed-totalIncome" class="text-2xl font-bold text-green-700">0 â‚ª</span>
                </div>
                <p class="text-xs text-gray-500 text-center mt-2">××§×“××” + ×ª×©×œ×•× ×‘×™×•× ×”××™×¨×•×¢</p>
            </div>
            
            <div class="flex gap-3">
                <button 
                    onclick="StageManager.confirmEventCompleted()" 
                    class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold transition-all">
                    âœ“ ××©×¨ ×•×©××•×¨
                </button>
                <button 
                    onclick="StageManager.skipEventCompleted()" 
                    class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-bold transition-all">
                    ×“×œ×’
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Settings -->
    <div id="modal-settings" class="modal">
        <div class="bg-white p-8 rounded-3xl w-full max-w-md shadow-2xl text-right">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-purple-800">âš™ï¸ ×”×’×“×¨×•×ª ×™×¢×“×™× ×©× ×ª×™×™×</h3>
                <button onclick="closeModal('modal-settings')" class="text-3xl text-gray-400 hover:text-gray-600">&times;</button>
            </div>
            
            <div class="space-y-6">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ’° ×™×¢×“ ×”×›× ×¡×•×ª ×©× ×ª×™ (â‚ª)</label>
                    <input type="number" id="goal-income" placeholder="×œ×“×•×’××”: 500000" class="w-full p-3 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-xl focus:border-purple-500 focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ‘° ×™×¢×“ ×›××•×ª ×›×œ×•×ª ×©× ×ª×™</label>
                    <input type="number" id="goal-brides" placeholder="×œ×“×•×’××”: 50" class="w-full p-3 border-2 border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-xl focus:border-purple-500 focus:outline-none">
                </div>
                
                <div class="bg-blue-50 p-4 rounded-xl border border-blue-200">
                    <p class="text-sm text-blue-800">
                        ğŸ’¡ <strong>×˜×™×¤:</strong> ×”×’×“×™×¨×• ×™×¢×“×™× ×××‘×™×¦×™×•×–×™×™× ××š ×¨×™××œ×™×™×. ××¢×§×‘ ××—×¨ ×”×ª×§×“××•×ª ×™×¢×–×•×¨ ×œ×›× ×œ×”×™×©××¨ ×××•×§×“×™×!
                    </p>
                </div>
            </div>
            
            <button onclick="saveGoals()" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 mt-6">
                ×©××•×¨ ×™×¢×“×™×
            </button>
        </div>
    </div>

    <!-- Modal: Manage Income Rows -->
    <div id="modal-manage" class="modal">
        <div class="bg-gray-800 dark:bg-gray-900 text-white rounded-3xl w-full max-w-5xl max-h-[85vh] overflow-hidden flex flex-col p-6 shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <button id="bulk-del-btn" onclick="bulkDelete()" class="hidden bg-red-500 hover:bg-red-600 text-white px-4 py-1 rounded-lg text-sm font-bold">
                    ××—×§ ××¡×•×× ×™×
                </button>
                <h3 class="text-xl font-bold text-white">× ×™×”×•×œ × ×ª×•× ×™ ×”×›× ×¡×•×ª</h3>
                <button onclick="closeModal('modal-manage')" class="text-3xl text-gray-300 hover:text-white">&times;</button>
            </div>
            
            <div class="overflow-x-auto overflow-y-auto flex-1">
                <table>
                    <thead class="sticky-thead bg-gray-700">
                        <tr class="text-right border-b border-gray-600">
                            <th class="p-3 text-gray-200">
                                <input type="checkbox" id="master-check" onclick="toggleSelectAll(this)" class="cursor-pointer">
                            </th>
                            <th class="p-3 text-gray-200">×ª××¨×™×š</th>
                            <th class="p-3 text-gray-200">×©×</th>
                            <th class="p-3 text-gray-200">×©×™×¨×•×ª</th>
                            <th class="p-3 text-gray-200">×¡×›×•×</th>
                            <th class="p-3 text-gray-200">×ª×©×œ×•×</th>
                            <th class="p-3 text-gray-200">×›×œ×”</th>
                            <th class="p-3 text-gray-200">×¤×¢×•×œ×•×ª</th>
                        </tr>
                    </thead>
                    <tbody id="manage-tbody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal: Edit Income Row -->
    <div id="modal-edit-row" class="modal">
        <div class="bg-gray-800 dark:bg-gray-900 text-white p-6 rounded-3xl w-full max-w-sm shadow-2xl text-right">
            <h3 class="text-xl font-bold mb-4 text-white">×¢×¨×™×›×ª ×¢×¡×§×”</h3>
            
            <input type="hidden" id="edit-id">
            <input type="text" id="edit-name" placeholder="×©× ×”×œ×§×•×—×”" class="bg-gray-700 text-white border-gray-600 placeholder-gray-400">
            <input type="number" id="edit-amount" placeholder="×¡×›×•×" class="bg-gray-700 text-white border-gray-600 placeholder-gray-400">
            <input type="text" id="edit-service" placeholder="×¡×•×’ ×©×™×¨×•×ª" class="bg-gray-700 text-white border-gray-600 placeholder-gray-400">
            <input type="date" id="edit-date" class="bg-gray-700 text-white border-gray-600">
            
            <select id="edit-payment" class="mb-4 bg-gray-700 text-white border-gray-600">
                <option value="××–×•××Ÿ">××–×•××Ÿ</option>
                <option value="×‘×™×˜">×‘×™×˜ / ×¤×™×™×‘×•×§×¡</option>
                <option value="×”×¢×‘×¨×”">×”×¢×‘×¨×” ×‘× ×§××™×ª</option>
                <option value="×›×¨×˜×™×¡ ××©×¨××™">×›×¨×˜×™×¡ ××©×¨××™</option>
                <option value="×”××—××”">×”××—××”</option>
            </select>
            
            <label class="flex items-center gap-2 p-3 bg-purple-900/30 border border-purple-700 rounded-xl mb-4">
                <input type="checkbox" id="edit-isbride" class="cursor-pointer">
                <span class="font-bold text-purple-200">×¢×¡×§×ª ×›×œ×”</span>
            </label>
            
            <button onclick="submitEdit()" id="btn-edit-save" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-xl font-bold transition-all">
                ×©××•×¨ ×©×™× ×•×™×™×
            </button>
            <button onclick="closeModal('modal-edit-row')" class="w-full text-gray-400 hover:text-gray-200 mt-2 transition-all">
                ×‘×™×˜×•×œ
            </button>
        </div>
    </div>

    <!-- Modal: Message Settings (WhatsApp Automation) -->
    <div id="modal-message-settings" class="modal">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-3xl w-full max-w-4xl shadow-2xl text-right max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-white dark:bg-gray-800 pb-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-2xl font-bold text-purple-800 dark:text-purple-300">âš™ï¸ ×”×’×“×¨×•×ª ×”×•×“×¢×•×ª WhatsApp</h3>
                <button onclick="closeModal('modal-message-settings')" class="text-3xl text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100">&times;</button>
            </div>
            
            <div id="message-settings-content" class="space-y-6">
                <!-- Content will be generated by MessageSettings.render() -->
            </div>
            
            <div class="sticky bottom-0 bg-white dark:bg-gray-800 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6">
                <button onclick="MessageSettings.save()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-xl font-bold transition-all">
                    ×©××•×¨ ×”×’×“×¨×•×ª
                </button>
            </div>
        </div>
    </div>

    <!-- Timer Settings Modal -->
    <div id="modal-timer-settings" class="modal">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-3xl w-full max-w-4xl shadow-2xl text-right max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-white dark:bg-gray-800 pb-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-2xl font-bold text-purple-800 dark:text-purple-300">â° ×”×’×“×¨×•×ª ×˜×™×™××¨×™×</h3>
                <button onclick="closeModal('modal-timer-settings')" class="text-3xl text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100">&times;</button>
            </div>
            
            <div id="timer-settings-content" class="space-y-6">
                <!-- Content will be generated by TimerSettings.render() -->
            </div>
            
            <div class="sticky bottom-0 bg-white dark:bg-gray-800 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6">
                <button onclick="TimerSettings.save()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-xl font-bold transition-all">
                    ×©××•×¨ ×”×’×“×¨×•×ª
                </button>
            </div>
        </div>
    </div>

    <!-- Application Script -->
    <script src="js/app_db.js?v=27122025d"></script>
</body>
</html>
